
\begin{DoxyEnumerate}
\item To build and run the new tests, one must pass {\ttfamily -\/D\+E\+N\+A\+B\+L\+E\+\_\+\+T\+E\+ST=on} to cmake (see \mbox{\hyperlink{md___users_flavio_tmp_documentation-update__h_elib__i_n_s_t_a_l_l}{I\+N\+S\+T\+A\+LL.md}}). The google test library will then be downloaded and the correct targets will be defined for cmake.
\item To compile them, {\ttfamily make} as normal from a build directory.
\item The entire set of tests can be run with\+:
\begin{DoxyItemize}
\item {\ttfamily ./bin/run\+Tests} or {\ttfamily ./dependencies/\+Build/helib\+\_\+external/bin/run\+Tests} if {\ttfamily P\+A\+C\+K\+A\+G\+E\+\_\+\+B\+U\+I\+LD=ON}. The parameters {\ttfamily no\+Print}, {\ttfamily dry} and {\ttfamily verbose} can be specified as before, but they will apply to all tests which are run.
\item {\ttfamily ctest}. In this case the output will be significantly less verbose and therefore less helpful in the case of a failure. The parameter {\ttfamily -\/-\/output-\/on-\/failure} can be added to display the output of each test that happened to fail. It is also possible to run tests in parallel by using {\ttfamily -\/j$<$number of concurrent tests$>$}. Detailed output of the tests (as if run directly with {\ttfamily run\+Tests}) can be found in {\ttfamily Testing/\+Temporary/\+Last\+Test.\+log}.
\item {\ttfamily make test}, which will run the tests through {\ttfamily ctest}. In this case no arguments can be passed. Detailed output of the tests (as if run directly with {\ttfamily run\+Tests}) can be found in {\ttfamily Testing/\+Temporary/\+Last\+Test.\+log}.
\end{DoxyItemize}
\end{DoxyEnumerate}\hypertarget{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md28}{}\doxysection{Running a subset of the tests}\label{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md28}
One may often want to run a specific test or set of tests. This is achieved using google test\textquotesingle{}s built-\/in \textquotesingle{}filtering\textquotesingle{} system. To run only the {\ttfamily Poly\+Eval} tests, for example, one simply runs 
\begin{DoxyCode}{0}
\DoxyCodeLine{./bin/runTests -\/-\/gtest\_filter='*PolyEval*'}
\end{DoxyCode}


To list all the tests, use {\ttfamily ./bin/run\+Tests -\/-\/gtest\+\_\+list\+\_\+tests}. More details on this filtering can be found in Google\textquotesingle{}s documentation \href{https://github.com/google/googletest/blob/master/googletest/docs/advanced.md\#running-a-subset-of-the-tests}{\texttt{ here}}.

It is also possible to run a specific test using {\ttfamily ctest} by adding the argument {\ttfamily -\/R \char`\"{}$<$name of the test$>$\char`\"{}}. For example to run only the {\ttfamily Poly\+Eval} test one simply runs 
\begin{DoxyCode}{0}
\DoxyCodeLine{ctest -\/R "{}PolyEval"{}}
\end{DoxyCode}


To list all the tests, use {\ttfamily ctest -\/N}. More details on this filtering can be found in the {\ttfamily ctest} documentation {\ttfamily ctest -\/-\/help}.\hypertarget{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md29}{}\doxysection{Changing parameters}\label{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md29}
The majority of the tests currently residing in {\ttfamily tests} are ported from the old tests which took several parameters. This maps reasonably well onto google test\textquotesingle{}s \textquotesingle{}Parameterised tests\textquotesingle{}, more of which can be read about \href{https://github.com/google/googletest/blob/master/googletest/docs/advanced.md\#value-parameterized-tests}{\texttt{ here}}.

Currently, the parameters to run tests with are written in the tests themselves, and require modification in the code to run with different parameters. Some runtime overriding of these parameters would be possible by placing a function call in the {\ttfamily I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P} macro, but this has not been done yet.\hypertarget{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md30}{}\doxysection{Writing new tests}\label{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md30}
\hypertarget{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md31}{}\doxysubsection{Why google test?}\label{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md31}
The google test framework gives us a few of main benefits\+:


\begin{DoxyItemize}
\item The presence of \textquotesingle{}fixtures\textquotesingle{}, which are classes to contain common set-\/up and teardown code. These are created by inheriting from {\ttfamily \+::testing\+::\+Test} or {\ttfamily \+::testing\+::\+Test\+With\+Param$<$T$>$}, and typically have a name such as {\ttfamily G\+Test\+\_\+extract\+Digits}.
\item A rich set of expectation/assertion macros, such as {\ttfamily E\+X\+P\+E\+C\+T\+\_\+\+EQ}, {\ttfamily E\+X\+P\+E\+C\+T\+\_\+\+GT}, and many more which can be read about \href{https://github.com/google/googletest/blob/master/googletest/docs/primer.md}{\texttt{ here}}. A test will typically contain at least one of these, the result of which determines the success or failure of the test.
\item A convenient runner which provides utilities such as filtering, repeating, shuffling, and convenient, consistent printouts. This adds significant convenience when only some tests are failing, since a summary as printed at the end specifying which tests failed, with which parameters they failed, etc.
\end{DoxyItemize}\hypertarget{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md32}{}\doxysubsection{Summary of how to write a google test}\label{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md32}

\begin{DoxyEnumerate}
\item Create a new file for the tests, let\textquotesingle{}s say called {\ttfamily G\+Test\+\_\+foo.\+cpp}.
\item Add {\ttfamily G\+Test\+\_\+foo.\+cpp} and {\ttfamily G\+Test\+\_\+foo} to the appropriate lists in {\ttfamily tests/\+C\+Make\+Lists.\+txt}.
\item In {\ttfamily G\+Test\+\_\+foo.\+cpp}, be sure to include both {\ttfamily \char`\"{}gtest/gtest.\+h\char`\"{}} and {\ttfamily "{}test\+\_\+common.\+h}. The latter will give access to the parameters {\ttfamily helib\+\_\+test\+::dry}, {\ttfamily helib\+\_\+test\+::no\+Print}, {\ttfamily helib\+\_\+test\+::special\+\_\+bits}, {\ttfamily helib\+\_\+test\+::verbose}, and {\ttfamily helib\+\_\+test\+::seed}.
\item Create an anonymous namespace in which to put everything, so that the global namespace for the test runner is not polluted.
\item Create a class called {\ttfamily G\+Test\+\_\+foo}, inheriting from {\ttfamily \+::testing\+::\+Test} or {\ttfamily \+::testing\+::\+Test\+With\+Param$<$some\+\_\+type$>$} for non-\/parameterized or parameterized tests (respectively). Common setup and teardown code/data should be placed in this class.
\item Create actual test code inside a {\ttfamily T\+E\+S\+T\+\_\+F} or {\ttfamily T\+E\+S\+T\+\_\+P} for non-\/parameterized or parameterized tests (respectively).
\item If using parameterized tests, create some parameters to run the tests with using the {\ttfamily I\+N\+S\+T\+A\+N\+T\+I\+A\+T\+E\+\_\+\+T\+E\+S\+T\+\_\+\+C\+A\+S\+E\+\_\+P} macro.
\end{DoxyEnumerate}\hypertarget{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md33}{}\doxysubsection{Further reading}\label{md___users_flavio_tmp_documentation-update__h_elib__t_e_s_t_s_autotoc_md33}
More details on how to use these google test utilities can be found by the helpful google test documentation\+:


\begin{DoxyItemize}
\item Basic overview\+: \href{https://github.com/google/googletest/}{\texttt{ https\+://github.\+com/google/googletest/}}
\item Introduction to using google test\+: \href{https://github.com/google/googletest/blob/master/googletest/docs/primer.md}{\texttt{ https\+://github.\+com/google/googletest/blob/master/googletest/docs/primer.\+md}}
\item More detailed documentation\+: \href{https://github.com/google/googletest/blob/master/googletest/README.md}{\texttt{ https\+://github.\+com/google/googletest/blob/master/googletest/\+R\+E\+A\+D\+M\+E.\+md}}
\item Advanced features\+: \href{https://github.com/google/googletest/blob/master/googletest/docs/advanced.md}{\texttt{ https\+://github.\+com/google/googletest/blob/master/googletest/docs/advanced.\+md}}
\end{DoxyItemize}

It may also be helpful to look at the existing examples of the above style of testing, which can be found in the {\ttfamily src/tests} folder. 